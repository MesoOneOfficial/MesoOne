<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>MesoOne – UK Severe Weather</title>
<style>
:root {
  --bg-color: #e1e1e1;
  --text-color: #222;
  --header-bg: #000;
  --header-color: #fbcf2f;
  --tagline-color: #aaaaaa;
  --article-bg: #fff;
  --article-border: #999;
  --footer-bg: #000;
  --footer-color: #fff;
  --link-color: #0066cc;
  --link-hover: #004499;
}
body.dark-mode {
  --bg-color: #1e1e1e;
  --text-color: #e0e0e0;
  --header-bg: #111;
  --header-color: #fbcf2f;
  --tagline-color: #cccccc;
  --article-bg: #222;
  --article-border: #555;
  --footer-bg: #111;
  --footer-color: #f0f0f0;
  --link-color: #66aaff;
  --link-hover: #3399ff;
}
body {
  font-family: Arial, sans-serif;
  background: var(--bg-color);
  color: var(--text-color);
  margin: 0;
  padding: 0;
}
header {
  display: flex;
  flex-direction: column;
  align-items: center;
  background: var(--header-bg);
  color: var(--header-color);
  padding: 20px;
}
.header-top {
  display: flex;
  justify-content: space-between;
  align-items: center;
  width: 100%;
  max-width: 1200px;
}
.header-left h1 { margin:0; font-size:2rem; color: var(--header-color); }
.header-left .tagline { margin-top:5px; font-size:0.9rem; color: var(--tagline-color); }
.header-right .logo { height:60px; width:auto; }
#mode-toggle {
  background:none; border:2px solid var(--header-color); color:var(--header-color);
  padding:5px 10px; cursor:pointer; font-size:0.9rem; border-radius:4px;
}
#mode-toggle:hover { background:var(--header-color); color:var(--header-bg); }
nav { margin-top:15px; text-align:center; }
nav a { color:var(--header-color); text-decoration:none; margin:0 15px; font-weight:bold; }
nav a:hover { color:var(--link-hover); }
main { display:flex; justify-content:center; width:100%; }
.container { width:100%; max-width:1200px; margin:30px auto; padding:0 20px; }
article { background:var(--article-bg); padding:20px; margin-bottom:20px; border:2px solid var(--article-border); border-radius:6px; }
#warnings-list { list-style-type:none; padding:0; display:flex; flex-direction:column; gap:10px; }
#warnings-list li { margin:0; }
.warning-link {
  display:block; padding:10px 15px; border-radius:6px; color:#000; font-weight:bold;
  text-decoration:none; transition:all 0.3s ease; border:2px solid transparent;
}
.warning-yellow { background:#fff700; border-color:#f5e500; color:#000; }
.warning-amber  { background:#ffbf00; border-color:#e6a800; color:#000; }
.warning-red    { background:#ff4c4c; border-color:#e63939; color:#fff; }
.warning-link:hover { transform: scale(1.02); opacity:0.9; }
footer { background:var(--footer-bg); color:var(--footer-color); text-align:center; padding:15px; }
@media(max-width:900px){.header-top{flex-direction:column;align-items:center;} nav{margin-top:10px;}}
</style>
</head>
<body>
<header>
  <div class="header-top">
    <div class="header-left">
      <h1>MesoOne</h1>
      <p class="tagline">Severe weather interception, research and alerts.</p>
    </div>
    <div class="header-right">
      <img src="MesoOneLogo.png" alt="Logo" class="logo" />
      <button id="mode-toggle">Toggle Dark Mode</button>
    </div>
  </div>
  <nav>
    <a href="index.html">Home</a>
    <a href="usa.html">USA Page</a>
    <a href="uk.html">UK Page</a>
  </nav>
</header>

<main>
  <div class="container">
    <article>
      <h2>UK Severe Weather Warnings</h2>
      <ul id="warnings-list"><li>Loading warnings…</li></ul>
    </article>
    <article>
      <h2>UK Forecast</h2>
      <p id="forecast-uk">Forecast content will go here…</p>
    </article>
  </div>
</main>

<footer>
  <p>We are not an official Met Office site!/p>
</footer>

<script>
const modeBtn = document.getElementById('mode-toggle');
modeBtn.addEventListener('click', ()=>{ document.body.classList.toggle('dark-mode'); });

// Met Office RSS feed
const RSS_URL = 'https://weather.metoffice.gov.uk/public/data/PWSCache/WarningsRSS/Region/UK';
const CORS_PROXY = 'https://api.allorigins.win/raw?url=' + encodeURIComponent(RSS_URL);

async function fetchUKWarnings(){
  const list = document.getElementById('warnings-list');
  list.innerHTML='<li>Loading warnings…</li>';
  try{
    const response = await fetch(CORS_PROXY);
    const xmlText = await response.text();
    const parser = new DOMParser();
    const xmlDoc = parser.parseFromString(xmlText,'text/xml');
    const items = xmlDoc.getElementsByTagName('item');
    list.innerHTML='';
    if(!items || items.length===0){ list.innerHTML='<li>No current warnings.</li>'; return; }
    for(let i=0;i<items.length;i++){
      const item = items[i];
      const title = item.getElementsByTagName('title')[0]?.textContent || 'No title';
      const link = item.getElementsByTagName('link')[0]?.textContent || '#';

      // Determine severity based on title text
      let severityClass='warning-yellow'; // default yellow
      if(title.toLowerCase().includes('amber')) severityClass='warning-amber';
      else if(title.toLowerCase().includes('red')) severityClass='warning-red';

      const li=document.createElement('li');
      li.innerHTML=`<a href="${link}" target="_blank" class="warning-link ${severityClass}">${title}</a>`;
      list.appendChild(li);
    }
  }catch(err){
    console.error('Error loading RSS:',err);
    list.innerHTML='<li>Unable to load warnings.</li>';
  }
}

fetchUKWarnings();
setInterval(fetchUKWarnings,15*60*1000);
</script>
</body>
</html>
